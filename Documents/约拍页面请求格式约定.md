# 约拍

| url                 | 说明       |
| ------------------- | -------- |
| /appointment/create | 创建约拍     |
| /appointment/ask    | 获得约拍系列信息 |



# 发布约拍

@author：黄鑫晨&李嘉文

#### 1.通信流程

1. 客户端发起约拍或活动请求，附带基本数据
2. 服务器返回是否许可，如许可，附带上传图片凭证
3. 客户端收到许可后用凭证将图片上传至云存储
4. 客户端上传图片成功后发所有文本数据给服务器
5. 服务器将数据录入后返回

#### 2.请求码与返回码

10200：服务器返回请求成功

10201：客户端请求，摄影师发布约拍

10202：客户端请求，模特发布约拍

10205：客户端提示服务器传图成功，开始传文本数据

#### 3.请求格式

格式10201：

| 字段名      | 描述                     |
| -------- | ---------------------- |
| phone    | String类型，用户ID，目前是手机号   |
| auth_key | String类型，是登陆成功时返回的密授权码 |
| title    | String类型，是摄影师发布约拍的标题   |
| type     | String类型，值为10201，状态码   |
| imgs     | JSON列表，装所有的String      |

示例请求(HTTP POST)：

{

​	username:“17702340987”,

​	auth_key:"sa_dn13g4oin587w_j7f802390q9_wd2",

​	title:"优惠接江宁大学城毕业季集体照拍摄，先到先得",

​	type:"10201"

}

### 实例返回值：

成功并获得授权：

```json
{
  "Code": 10200, 
  "code": 200, 
  "contents": {
    "apId": [
      26
    ], 
    "auth_key": [
      "yzAza_Cm87nXkh9IyFfpg7LL7qKJ097VK5IOpLj0:q1VckAHk4MqUrVgQPco_fs-H3uY=:eyJzY29wZSI6InNoYWN1czphc2R3LnBuZyIsImRlYWRsaW5lIjoxNDcyNTIyOTU2fQ==", 
      "yzAza_Cm87nXkh9IyFfpg7LL7qKJ097VK5IOpLj0:q1VckAHk4MqUrVgQPco_fs-H3uY=:eyJzY29wZSI6InNoYWN1czphc2R3LnBuZyIsImRlYWRsaW5lIjoxNDcyNTIyOTU2fQ==", 
      "yzAza_Cm87nXkh9IyFfpg7LL7qKJ097VK5IOpLj0:uXoq4rlLQdmBS4DtAhd-ZZnM8fA=:eyJzY29wZSI6InNoYWN1czpxcnVvLmpwZWciLCJkZWFkbGluZSI6MTQ3MjUyMjk1Nn0="
    ]
  }
}
```

## 错误返回code说明如下：

| code  | 说明                         |
| ----- | -------------------------- |
|       |                            |
| 10210 | 该约拍已存在                     |
| 10211 | 用户授权码错误                    |
| 10212 | 该用户名不存在                    |
| 10213 | 该发布尚未获得权限（即未执行10201/10202） |
| 10214 | 用户授权码不存在或已过期               |



约拍已存在：

```json
{
  "Code": "10210", 
  "code": "200", 
  "contents": "该约拍已存在"
}
```

auth_key错误：

```json
{
  "Code": "10211", 
  "code": "200", 
  "contents": "用户认证码错误"
}
```



格式10202：

| 字段名      | 描述                     |
| -------- | ---------------------- |
| username | String类型，用户ID，目前是手机号   |
| auth_key | String类型，是登陆成功时返回的密授权码 |
| title    | String类型，是模特发布约拍的标题    |
| type     | String类型，值为10202，状态码   |

示例请求(HTTP POST)：

{

​	username:“17702340987”,

​	auth_key:"6_uaef092tjt_w7f80b25pjytio3rn_e",

​	title:"约东大湖区附近摄影师拍摄艺术照，可付费",

​	type:"10202"

}



格式10203：

| 字段名      | 描述                     |
| -------- | ---------------------- |
| username | String类型，用户ID，目前是手机号   |
| auth_key | String类型，是登陆成功时返回的密授权码 |
| title    | String类型，是模特发布约拍的标题    |
| type     | String类型，值为10202，状态码   |

示例请求(HTTP POST)：

{

​	username:“17702340987”,

​	auth_key:"s1vdl_7w2tjt_w7ff8n25pjytimu74_p",

​	title:"东大摄协年会，欢迎前来捧场",

​	type:"10203"

}



格式10205：

| 字段名        | 描述                                       |
| ---------- | ---------------------------------------- |
| ap_type    | 约拍类型，1为摄影师约模特，2为模特约摄影师                   |
| auth_key   | String类型，是登陆成功时返回的密授权码                   |
| title      | String类型，是约拍/活动的标题                       |
| type       | String类型，值为10205，状态码                     |
| apid       | String类型，约拍/活动号id，是服务器在响应10201/10202/10203时返回的，服务器收到后用其更新数据库 |
| tags       | String类型，标签，以\|分隔                        |
| start_time | String类型，开始时间，格式YYYY/MM/DD 周一 HH:MM      |
| end_time   | String类型，开始时间，格式YYYY/MM/DD 周一 HH:MM      |
| join_time  | String类型，报名时间，格式YYYY/MM/DD 周一 HH:MM      |
| loaction   | String类型，地点描述信息，38字以内                    |
| free       | String类型，值为1(免费)或0(收费)                   |
| price      | String类型，价格描述信息，10字以内（如果收费）              |
| contents   | String类型，详细介绍及要求，20字以上                   |
| ap_allowed | Boolean类型，表示是否允许蹭拍,第一版本默认为0              |
|            |                                          |

示例请求：略

## 实例返回值

### 约拍已存在：

```json
{
  "code": "10210", 
  "contents": "该约拍已存在"
}
```

### 未获得权限：

```json
{
  "code": "10213", 
  "contents": "该发布尚未获得权限！"
}
```

### 发布成功：

```json
{
  "code": "10200", 
  "contents": "发布约拍成功"
}
```
# 请求约拍

@author:黄鑫晨

参数type（String）作为约拍请求分类，说明如下：

| type值 | 说明                                   |
| ----- | ------------------------------------ |
| 10231 | 获得所有摄影师发布的未关闭的约拍，以地点为筛选条件（目前默认为全部约拍） |
| 10235 | 获得所有模特发布的未关闭的约拍，以地点为筛选条件（目前默认为全部约拍）  |
| 10240 | 请求用户自己发布的所有约拍                        |
| 10241 | 获得指定用户发布的所有约拍                        |
| 10251 | 请求约拍详情                               |
| 10250 | 请求成功                                 |
| 10251 | 未找到约拍记录                              |
| 10260 | 刷新并拿到指定Id后的6个摄影师发布的约拍                |
| 10261 | 刷新并拿到指定Id后的6个模特发布的约拍                 |
| 10262 | 刷新成功                                 |
| 10263 | 剩余约拍不足6个，返回剩余全部约拍                    |
| 10264 | 没有更多约拍                               |

## 10231 ：请求获得所有未关闭的摄影师发布的约拍，以地点为筛选条件（目前默认为全部约拍）

| 参数      | 类型          | 说明/值         |
| ------- | ----------- | ------------ |
| authkey | VARCHAR(32) | 用户认证码        |
| uid     | Integer     |              |
| type    | String      | 请求类型，值为10231 |

## 示例返回值：

```json
{
  "code": "10250", 
  "contents": [
    {
      "APtitle": "摄影师约拍1", 
      "APid": 11, 
      "APimgurl": "http://img9.jiwu.com/jiwu_news_pics/20151225/1450854576571_000.jpg", 
      "APstartT": "2016-09-12T00:00:00", 
      "APlikeN": 0, 
      "Userimg": "http://img5.imgtn.bdimg.com/it/u=1268523085,477716560&fm=21&gp=0.jpg", 
      "APregistN": 0
    }, 
    {
      "APtitle": "摄影师约拍4", 
      "APid": 12, 
      "APimgurl": "http://img9.jiwu.com/jiwu_news_pics/20151225/1450854576571_000.jpg", 
      "APstartT": "2016-09-12T00:00:00", 
      "APlikeN": 0, 
      "Userimg": "http://img5.imgtn.bdimg.com/it/u=1268523085,477716560&fm=21&gp=0.jpg", 
      "APregistN": 0
    }
  ]
}
```



## 10235：请求得所有模特发布的未关闭的约拍，以地点为筛选条件（目前默认为全部约拍）

| 参数      | 类型          | 说明/值         |
| ------- | ----------- | ------------ |
| authkey | VARCHAR(32) | 用户认证码        |
| type    | String      | 请求类型，值为10235 |
| uid     | Integer     |              |

## 示例返回值：

```json
{
  "code": "10250", 
  "contents": [
    {
      "APtitle": "模特约拍3", 
      "APid": 10, 
      "APimgurl": "http://img9.jiwu.com/jiwu_news_pics/20151225/1450854576571_000.jpg", 
      "APstartT": "2016-09-12T00:00:00", 
      "APlikeN": 0, 
      "Userimg": "http://img5.imgtn.bdimg.com/it/u=1268523085,477716560&fm=21&gp=0.jpg", 
      "APregistN": 0
    }
  ]
}
```

## 10240请求用户自己发布的所有约拍

| 参数      | 类型          | 说明/值         |
| ------- | ----------- | ------------ |
| authkey | VARCHAR(32) | 用户认证码        |
| type    | String      | 请求类型，值为10240 |
| uid     | Integer     | 用户自己的Id      |

## 10241请求指定用户发布的所有约拍

| 参数      | 类型          | 说明           |
| ------- | ----------- | ------------ |
| authkey | VARCHAR(32) | 用户认证码        |
| type    | String      | 请求类型，值为10241 |
| uid     | Integer     | 用户自己的id      |
| finduid | Integer     | 指定用户的id      |

### 返回值实例：

```json
{
  "code": "", 
  "contents": [
    {
      "APtitle": "九龙湖大作战2", 
      "APendT": "2016-09-12T00:00:00", 
      "APlocation": "田青山", 
      "APid": 23, 
      "APcontent": "来一次愉快的畅快淋漓的外拍吧！", 
      "APfree": true, 
      "APtype": true, 
      "APjoinT": "2016-08-12T00:00:00", 
      "APvalid": true, 
      "APsponsorid": 1, 
      "APprice": 0.0, 
      "APtag": "暂无标签", 
      "APlikeN": 0, 
      "APcreateT": "2016-08-29T23:29:29", 
      "APstartT": "2016-09-12T00:00:00", 
      "APclosed": false, 
      "APaddallowed": false
    }, 
    {
      "APtitle": "9-30日上午约拍", 
      "APendT": "2016-09-12T00:00:00", 
      "APlocation": "田青山", 
      "APid": 24, 
      "APcontent": "来一次愉快的畅快淋漓的外拍吧！", 
      "APfree": true, 
      "APtype": true, 
      "APjoinT": "2016-08-12T00:00:00", 
      "APvalid": true, 
      "APsponsorid": 1, 
      "APprice": 0.0, 
      "APtag": "暂无标签", 
      "APlikeN": 0, 
      "APcreateT": "2016-08-30T08:46:10", 
      "APstartT": "2016-09-12T00:00:00", 
      "APclosed": false, 
      "APaddallowed": false
    }
  ]
}
```
## 10251 返回约拍详情 

| 参数      | 类型          | 说明           |
| ------- | ----------- | ------------ |
| authkey | VARCHAR(32) | 用户认证码        |
| uid     | Integer     | 用户自己的id      |
| type    | String      | 请求类型，值为10251 |
| apid    | Integer     | 约拍ID         |

## 10250

实例返回值：

```json
{
  "code": "10250", 
  "contents": {
    "APtitle": "摄影师约拍1", 
    "APregisters": [
      {
        "headImage": "https://ss2.bdstatic.com/70cFvnSh_Q1YnxGkpoWK1HF6hhy/it/u=2413410606,339859400&fm=21&gp=0.jpg ", 
        "id": 4
      }
    ], 
    "APendT": "2016-09-12T00:00:00", 
    "Userliked": 1, 
    "APid": 11, 
    "APstatus": null, 
    "APlikeN": 31, 
    "AP_issponsor": 1, 
    "APfree": 0, 
    "APtype": 1, 
    "APjoinT": "2016-08-12T00:00:00", 
    "APvalid": 1, 
    "APsponsorid": 3, 
    "APimgurl": [
      "http://img9.jiwu.com/jiwu_news_pics/20151225/1450854576571_000.jpg", 
      "http://p1.gexing.com/G1/M00/57/8B/rBACFFPcOFOiwBGVAACdMkF5UnM383.jpg", 
      "http://p1.gexing.com/G1/M00/57/8B/rBACFFPcOFOiwBGVAACdMkF5UnM383.jpg"
    ], 
    "APprice": null, 
    "APtag": null, 
    "APcontent": "来一次愉快的畅快淋漓的外拍吧！", 
    "APcreateT": "2016-09-03T10:12:48", 
    "APstartT": "2016-09-12T00:00:00", 
    "APregistN": 0, 
    "APlocation": "田青山", 
    "APaddallowed": 0
  }
}
```

```json
{
  "code": "10251", 
  "contents": "未查询到约拍记录"
}
```
# 报名约拍

| type  | 值               |
| ----- | --------------- |
| 10270 | 报名成功            |
| 10271 | 报名约拍            |
| 10272 | 用户认证错误          |
| 10273 | 已报名过改约拍         |
| 10274 | 数据库插入错误         |
|       |                 |
| 10275 | 取消报名            |
| 10276 | 取消报名成功          |
| 10277 | 用户已经取消报名        |
| 10278 | 用户未报名过该约拍       |
| 10279 | 授权码不存在或已过期      |
|       |                 |
| 10280 | 查看报名某个约拍的全部用户详情 |
|       |                 |

## 报名约拍 10271

| 参数      | 类型          | 说明           |
| ------- | ----------- | ------------ |
| authkey | VARCHAR(32) | 用户认证码        |
| uid     | Integer     | 用户自己的id      |
| type    | String      | 请求类型，值为10271 |
| apid    | Integer     | 约拍ID         |

## 取消报名约拍 10275

| 参数      | 类型   | 说明    |
| ------- | ---- | ----- |
| uid     |      |       |
| authkey |      |       |
| type    |      | 10252 |
| apid    |      |       |







## 10260  刷新并拿到指定Id后的6个约拍

| 参数         | 类型   | 说明           |
| ---------- | ---- | ------------ |
| uid        |      |              |
| authkey    |      |              |
| type       |      | 10260        |
| offsetapid |      | 上一次拿到的最后一个约拍 |



## 返回实例：

## 10262，刷新成功：

```json
{
  "code": "10262", 
  "contents": [
    {
      "APtitle": "摄影师约拍9", 
      "APimgurl": "http://img9.jiwu.com/jiwu_news_pics/20151225/1450854576571_000.jpg", 
      "Userimg": "http://img5.imgtn.bdimg.com/it/u=1268523085,477716560&fm=21&gp=0.jpg", 
      "Userliked": 0, 
      "APid": 20, 
      "APlikeN": 0, 
      "APstartT": "2016-09-12T00:00:00", 
      "APregistN": 0
    }, 
    {
      "APtitle": "摄影师约拍8", 
      "APimgurl": "http://img9.jiwu.com/jiwu_news_pics/20151225/1450854576571_000.jpg", 
      "Userimg": "http://img5.imgtn.bdimg.com/it/u=1268523085,477716560&fm=21&gp=0.jpg", 
      "Userliked": 0, 
      "APid": 19, 
      "APlikeN": 0, 
      "APstartT": "2016-09-12T00:00:00", 
      "APregistN": 0
    }, 
    {
      "APtitle": "摄影师约拍7", 
      "APimgurl": "http://img9.jiwu.com/jiwu_news_pics/20151225/1450854576571_000.jpg", 
      "Userimg": "http://img5.imgtn.bdimg.com/it/u=1268523085,477716560&fm=21&gp=0.jpg", 
      "Userliked": 0, 
      "APid": 18, 
      "APlikeN": 0, 
      "APstartT": "2016-09-12T00:00:00", 
      "APregistN": 0
    }, 
    {
      "APtitle": "摄影师约拍6", 
      "APimgurl": "http://img9.jiwu.com/jiwu_news_pics/20151225/1450854576571_000.jpg", 
      "Userimg": "http://img5.imgtn.bdimg.com/it/u=1268523085,477716560&fm=21&gp=0.jpg", 
      "Userliked": 0, 
      "APid": 17, 
      "APlikeN": 0, 
      "APstartT": "2016-09-12T00:00:00", 
      "APregistN": 0
    }, 
    {
      "APtitle": "摄影师约拍5", 
      "APimgurl": "http://img9.jiwu.com/jiwu_news_pics/20151225/1450854576571_000.jpg", 
      "Userimg": "http://img5.imgtn.bdimg.com/it/u=1268523085,477716560&fm=21&gp=0.jpg", 
      "Userliked": 0, 
      "APid": 16, 
      "APlikeN": 0, 
      "APstartT": "2016-09-12T00:00:00", 
      "APregistN": 0
    }
  ]
}
```



# 选择约拍对象

